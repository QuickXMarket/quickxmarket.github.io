<!DOCTYPE html>
<html>
  <head>
    <script type="module" src="main.js"></script>
    <link rel="icon" href="../images/cart.png" sizes="16×16" />
    <link rel="stylesheet" href="../css/bootstrap.css" />
    <link rel="stylesheet" href="style.css" />
    <meta name="theme-color" content="#000137" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Complete Order</title>
  </head>
  <body>
    <div id="div1">
      <div id="option"></div>
      <div class="div2" style="color: #000137; vertical-align: middle">
        <span style="color: white; vertical-align: middle">Complete Order</span>
      </div>
    </div>

    <div id="body" class="completeOrder">
      <div class="container">
        <div class="card view">
          <div class="card-body">
            <h5 class="card-title addressDetails">Address Details</h5>
            <a href="../Address-Book/" class="card-link changeAddress"
              >Change Address Details</a
            >

            <p id="name" class="card-text name" style="color: #000137">
              <!-- User's Name -->
            </p>
            <p id="hostel" class="card-text hostel">
              <!-- User's Hostel -->
            </p>
            <p id="phone" class="card-text phone">
              <!-- User's Phone Number -->
            </p>

            <hr />

            <div class="row flex">
              <div class="col subtotal">Subtotal</div>
              <div id="subtotal" class="col subtotalValue">
                <!-- Dynamic subtotal value -->
              </div>
            </div>

            <div class="row flex">
              <div class="col shipping">Shipping</div>
              <div class="col shippingValue">₦100</div>
            </div>

            <div class="row flex">
              <div class="col total">Total</div>
              <div id="total" class="col totalValue">
                <!-- Dynamic total value -->
              </div>
            </div>

            <hr />

            <form id="paymentForm" class="paymentForm">
              <button
                id="paystack_payment"
                type="submit"
                class="btn btn-primary"
              >
                Continue Payment
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <div id="loader"></div>
    <script src="https://js.paystack.co/v1/inline.js"></script>

    <!-- <script type="module">
      import { uploadAdminOrder } from "./main.js";

      var details = JSON.parse(localStorage.getItem("details"));
      function payWithPaystack(e) {
        var email = details["email"];
        var amount = sessionStorage.getItem("amount");
        e.preventDefault();
        let handler = PaystackPop.setup({
          key: "pk_test_3ad69a99a3675265dacd246fee09d0ec0a4b3a1b", // Replace with your public key
          email: email,
          amount: amount * 100,
          ref: "Mudia" + Math.floor(Math.random() * 1000000000 + 1), // generates a pseudo-unique reference. Please replace with a reference you generated. Or remove the line entirely so our API will generate one for you

          onClose: function () {},
          callback: function (response) {
            let message = "Payment complete! Reference: " + response.reference;

            fetch(
              "https://api.paystack.co/transaction/verify/" +
                response.reference,
              {
                headers: {
                  Authorization:
                    "Bearer sk_test_e3a39ba27e5d0722ddc6f1e89afaa4bd9c180225",
                },
              }
            )
              .then((res) => res.json())
              .then((data) => {
                var status = data["data"]["status"];
                if (status === "success") {
                  var s_email = data["data"]["customer"]["email"];
                  var reference = data["data"]["reference"];
                  var date = new Date();
                  var date_time =
                    date.getMonth() +
                    1 +
                    "/" +
                    date.getDate() +
                    "/" +
                    date.getFullYear() +
                    " " +
                    date.getHours() +
                    ":" +
                    date.getMinutes();
                  document.getElementById("body").style.display = "none";
                  document.getElementById("loader").style.display = "block";
                  uploadAdminOrder();
                }
              });
          },
        });
        handler.openIframe();
      }
    </script> -->
    <script src="../js/bootstrap.bundle.js"></script>
  </body>
</html>
